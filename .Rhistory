ggplot(data = data1, aes(x = reorder(Species, response), y = response * 100)) +
geom_point(size=2) +
ylim(c(0, 40)) +
geom_errorbar(aes(ymin = 100*(response - SE),
ymax = 100*(response+SE)),
width=0, size=0.5) +
labs(x="Species", y = "Model Predicted *Phragmites* Cover (%)") +
geom_text(aes(label = .group,  y = response * 100),
nudge_y = 4, nudge_x = .3, size = 3) +
theme(axis.text.x = element_text(angle = 45, hjust = 0.9),
axis.title.y = ggtext::element_markdown())
## Phrag species ####
c <- ggplot(data = data1, aes(x = reorder(Species, response), y = response)) +
geom_point(size=2) +
ylim(c(0, 40)) +
geom_errorbar(aes(ymin = (response - SE),
ymax = (response+SE)),
width=0, size=0.5) +
labs(x="Native Species Identity", y = "Model Predicted <br> Proportional *P.australis* Cover",
title = "(a)") +
geom_text(aes(label = .group,  y = response),
nudge_y = 4, size = 3) +
theme(axis.text.x = element_text(angle = 45, hjust = 0.9),
axis.title.y = ggtext::element_markdown(size = 11),
plot.title = element_text(size = 9))
d <- ggplot(data = data3, aes(x = reorder(Species, response), y = response)) +
geom_point(size=2) +
geom_errorbar(aes(ymin = (response - SE),
ymax = (response+SE)),
width=0, size=0.5) +
labs(x="Native Species Identity", y = "Model Predicted <br> *P.australis* Biomass (g)",
title = "(b)") +
geom_text(aes(label = .group,  y = response),
nudge_y = 3.5, size = 3) +
theme(axis.text.x = element_text(angle = 45, hjust = 0.9),
axis.title.y = ggtext::element_markdown(size = 11),
plot.title = element_text(size = 9))
c / d
## Phrag species ####
c <- ggplot(data = data1, aes(x = reorder(Species, response), y = response)) +
geom_point(size=2) +
ylim(c(0, 1)) +
geom_errorbar(aes(ymin = (response - SE),
ymax = (response+SE)),
width=0, size=0.5) +
labs(x="Native Species Identity", y = "Model Predicted <br> Proportional *P.australis* Cover",
title = "(a)") +
geom_text(aes(label = .group,  y = response),
nudge_y = 4, size = 3) +
theme(axis.text.x = element_text(angle = 45, hjust = 0.9),
axis.title.y = ggtext::element_markdown(size = 11),
plot.title = element_text(size = 9))
d <- ggplot(data = data3, aes(x = reorder(Species, response), y = response)) +
geom_point(size=2) +
geom_errorbar(aes(ymin = (response - SE),
ymax = (response+SE)),
width=0, size=0.5) +
labs(x="Native Species Identity", y = "Model Predicted <br> *P.australis* Biomass (g)",
title = "(b)") +
geom_text(aes(label = .group,  y = response),
nudge_y = 3.5, size = 3) +
theme(axis.text.x = element_text(angle = 45, hjust = 0.9),
axis.title.y = ggtext::element_markdown(size = 11),
plot.title = element_text(size = 9))
c / d
## Phrag species ####
c <- ggplot(data = data1, aes(x = reorder(Species, response), y = response)) +
geom_point(size=2) +
ylim(c(0, .5)) +
geom_errorbar(aes(ymin = (response - SE),
ymax = (response+SE)),
width=0, size=0.5) +
labs(x="Native Species Identity", y = "Model Predicted <br> Proportional *P.australis* Cover",
title = "(a)") +
geom_text(aes(label = .group,  y = response),
nudge_y = 4, size = 3) +
theme(axis.text.x = element_text(angle = 45, hjust = 0.9),
axis.title.y = ggtext::element_markdown(size = 11),
plot.title = element_text(size = 9))
d <- ggplot(data = data3, aes(x = reorder(Species, response), y = response)) +
geom_point(size=2) +
geom_errorbar(aes(ymin = (response - SE),
ymax = (response+SE)),
width=0, size=0.5) +
labs(x="Native Species Identity", y = "Model Predicted <br> *P.australis* Biomass (g)",
title = "(b)") +
geom_text(aes(label = .group,  y = response),
nudge_y = 3.5, size = 3) +
theme(axis.text.x = element_text(angle = 45, hjust = 0.9),
axis.title.y = ggtext::element_markdown(size = 11),
plot.title = element_text(size = 9))
c / d
ggplot(data = data1, aes(x = reorder(Species, response), y = response)) +
geom_point(size=2) +
ylim(c(0, .5)) +
geom_errorbar(aes(ymin = (response - SE),
ymax = (response+SE)),
width=0, size=0.5) +
labs(x="Native Species Identity", y = "Model Predicted <br> Proportional *P.australis* Cover",
title = "(a)") +
geom_text(aes(label = .group,  y = response),
nudge_y = 4, size = 3) +
theme(axis.text.x = element_text(angle = 45, hjust = 0.9),
axis.title.y = ggtext::element_markdown(size = 11),
plot.title = element_text(size = 9))
data1
## Phrag species ####
c <- ggplot(data = data1, aes(x = reorder(Species, response), y = response)) +
geom_point(size=2) +
ylim(c(0, .5)) +
geom_errorbar(aes(ymin = (response - SE),
ymax = (response+SE)),
width=0, size=0.5) +
labs(x="Native Species Identity", y = "Model Predicted <br> Proportional *P.australis* Cover",
title = "(a)") +
geom_text(aes(label = .group,  y = response)) +
theme(axis.text.x = element_text(angle = 45, hjust = 0.9),
axis.title.y = ggtext::element_markdown(size = 11),
plot.title = element_text(size = 9))
c
## Phrag species ####
c <- ggplot(data = data1, aes(x = reorder(Species, response), y = response)) +
geom_point(size=2) +
ylim(c(0, .5)) +
geom_errorbar(aes(ymin = (response - SE),
ymax = (response+SE)),
width=0, size=0.5) +
labs(x="Native Species Identity", y = "Model Predicted <br> Proportional *P.australis* Cover",
title = "(a)") +
geom_text(aes(label = .group,  y = response),
nudge_y = 1, size = 3) +
theme(axis.text.x = element_text(angle = 45, hjust = 0.9),
axis.title.y = ggtext::element_markdown(size = 11),
plot.title = element_text(size = 9))
c
## Phrag species ####
c <- ggplot(data = data1, aes(x = reorder(Species, response), y = response)) +
geom_point(size=2) +
ylim(c(0, .5)) +
geom_errorbar(aes(ymin = (response - SE),
ymax = (response+SE)),
width=0, size=0.5) +
labs(x="Native Species Identity", y = "Model Predicted <br> Proportional *P.australis* Cover",
title = "(a)") +
geom_text(aes(label = .group,  y = response),
nudge_y = .1, size = 3) +
theme(axis.text.x = element_text(angle = 45, hjust = 0.9),
axis.title.y = ggtext::element_markdown(size = 11),
plot.title = element_text(size = 9))
c
## Phrag species ####
c <- ggplot(data = data1, aes(x = reorder(Species, response), y = response)) +
geom_point(size=2) +
ylim(c(0, .5)) +
geom_errorbar(aes(ymin = (response - SE),
ymax = (response+SE)),
width=0, size=0.5) +
labs(x="Native Species Identity", y = "Model Predicted <br> Proportional *P.australis* Cover",
title = "(a)") +
geom_text(aes(label = .group,  y = response),
nudge_y = .05, size = 3) +
theme(axis.text.x = element_text(angle = 45, hjust = 0.9),
axis.title.y = ggtext::element_markdown(size = 11),
plot.title = element_text(size = 9))
c
## Phrag species ####
c <- ggplot(data = data1, aes(x = reorder(Species, response), y = response)) +
geom_point(size=2) +
ylim(c(0, .5)) +
geom_errorbar(aes(ymin = (response - SE),
ymax = (response+SE)),
width=0, size=0.5) +
labs(x="Native Species Identity", y = "Model Predicted <br> Proportional *P.australis* Cover",
title = "(a)") +
geom_text(aes(label = .group,  y = response),
nudge_y = .25, size = 3) +
theme(axis.text.x = element_text(angle = 45, hjust = 0.9),
axis.title.y = ggtext::element_markdown(size = 11),
plot.title = element_text(size = 9))
c
## Phrag species ####
c <- ggplot(data = data1, aes(x = reorder(Species, response), y = response)) +
geom_point(size=2) +
ylim(c(0, .5)) +
geom_errorbar(aes(ymin = (response - SE),
ymax = (response+SE)),
width=0, size=0.5) +
labs(x="Native Species Identity", y = "Model Predicted <br> Proportional *P.australis* Cover",
title = "(a)") +
geom_text(aes(label = .group,  y = response),
nudge_y = .025, size = 3) +
theme(axis.text.x = element_text(angle = 45, hjust = 0.9),
axis.title.y = ggtext::element_markdown(size = 11),
plot.title = element_text(size = 9))
c
## Phrag species ####
c <- ggplot(data = data1, aes(x = reorder(Species, response), y = response)) +
geom_point(size=2) +
ylim(c(0, .5)) +
geom_errorbar(aes(ymin = (response - SE),
ymax = (response+SE)),
width=0, size=0.5) +
labs(x="Native Species Identity", y = "Model Predicted <br> Proportional *P.australis* Cover",
title = "(a)") +
geom_text(aes(label = .group,  y = response),
nudge_y = .03, size = 3) +
theme(axis.text.x = element_text(angle = 45, hjust = 0.9),
axis.title.y = ggtext::element_markdown(size = 11),
plot.title = element_text(size = 9))
c
## Phrag species ####
c <- ggplot(data = data1, aes(x = reorder(Species, response), y = response)) +
geom_point(size=2) +
ylim(c(0, .5)) +
geom_errorbar(aes(ymin = (response - SE),
ymax = (response+SE)),
width=0, size=0.5) +
labs(x="Native Species Identity", y = "Model Predicted <br> Proportional *P.australis* Cover",
title = "(a)") +
geom_text(aes(label = .group,  y = response),
nudge_y = .03, size = 3) +
theme(axis.text.x = element_text(angle = 45, hjust = 0.9),
axis.title.y = ggtext::element_markdown(size = 11),
plot.title = element_text(size = 9))
d <- ggplot(data = data3, aes(x = reorder(Species, response), y = response)) +
geom_point(size=2) +
geom_errorbar(aes(ymin = (response - SE),
ymax = (response+SE)),
width=0, size=0.5) +
labs(x="Native Species Identity", y = "Model Predicted <br> *P.australis* Biomass (g)",
title = "(b)") +
geom_text(aes(label = .group,  y = response),
nudge_y = 3.5, size = 3) +
theme(axis.text.x = element_text(angle = 45, hjust = 0.9),
axis.title.y = ggtext::element_markdown(size = 11),
plot.title = element_text(size = 9))
c / d
## Phrag species ####
c <- ggplot(data = data1, aes(x = reorder(Species, response), y = response)) +
geom_point(size=2) +
ylim(c(0, .5)) +
geom_errorbar(aes(ymin = (response - SE),
ymax = (response+SE)),
width=0, size=0.5) +
labs(x="Native Species Identity", y = "Model Predicted <br> Proportional *P.australis* Cover",
title = "(a)") +
geom_text(aes(label = .group,  y = response),
nudge_y = .05, size = 3) +
theme(axis.text.x = element_text(angle = 45, hjust = 0.9),
axis.title.y = ggtext::element_markdown(size = 11),
plot.title = element_text(size = 9))
d <- ggplot(data = data3, aes(x = reorder(Species, response), y = response)) +
geom_point(size=2) +
geom_errorbar(aes(ymin = (response - SE),
ymax = (response+SE)),
width=0, size=0.5) +
labs(x="Native Species Identity", y = "Model Predicted <br> *P.australis* Biomass (g)",
title = "(b)") +
geom_text(aes(label = .group,  y = response),
nudge_y = 3.5, size = 3) +
theme(axis.text.x = element_text(angle = 45, hjust = 0.9),
axis.title.y = ggtext::element_markdown(size = 11),
plot.title = element_text(size = 9))
c / d
ggsave("phrag_cover_biomass_model_means_species.jpeg")
# Putting graphs side by side ####
##Phrag Density ####
a <- ggplot(data = data2, aes(x = Density, y = response * 100, color = Density)) +
ylim(c(0, 30)) +
geom_point(size=2) +
geom_errorbar(aes(ymin = 100*(response - SE),
ymax = 100*(response+SE)),
width=0, size=0.5) +
labs(x="Density", y = "Model Predicted Proportional *P.australis* Cover",
title = "(a)") +
geom_text(aes(label = .group,  y = response * 100),
nudge_x = .2, color = "black") +
theme(axis.title.y = ggtext::element_markdown(),
plot.title = element_text(size = 9),
legend.position = "none") +
scale_color_manual(values = color2)
b <- ggplot(data = data4, aes(x = Density, y = response, color = Density)) +
ylim(c(0, 20)) +
geom_point(size=2) +
geom_errorbar(aes(ymin = (response - SE),
ymax = (response+SE)),
width=0, size=0.5) +
labs(x="Density", y = "Model Predicted *P.australis* Biomass (g)",
title = "(b)") +
geom_text(aes(label = .group,  y = response),
nudge_x = .2, color = "black") +
theme(axis.title.y = ggtext::element_markdown(),
plot.title = element_text(size = 9),
legend.position = "none") +
scale_color_manual(values = color2)
a + b
?ggsave
ggsave("phrag_cover_biomass_model_means_tog.jpeg", width = 100, height = 200units = c("px"))
ggsave("phrag_cover_biomass_model_means_tog.jpeg", width = 100, height = 200, units = c("px"))
ggsave("phrag_cover_biomass_model_means_tog.jpeg", width = 500, height = 500, units = c("px"))
ggsave("phrag_cover_biomass_model_means_tog.jpeg", width = 5000, height = 5000, units = c("px"))
ggsave("phrag_cover_biomass_model_means_tog.jpeg", width = 3000, height = 3000, units = c("px"))
ggsave("phrag_cover_biomass_model_means_tog.jpeg", width =1000, height = 2000, units = c("px"))
ggsave("phrag_cover_biomass_model_means_tog.jpeg", width =800, height = 2000, units = c("px"))
ggsave("phrag_cover_biomass_model_means_tog.jpeg", width =800, height = 1000, units = c("px"))
ggsave("phrag_cover_biomass_model_means_tog.jpeg", width =800, height = 1100, units = c("px"))
ggsave("phrag_cover_biomass_model_means_tog.jpeg", width =600, height = 1000, units = c("px"))
ggsave("phrag_cover_biomass_model_means_tog.jpeg", width =700, height = 1000, units = c("px"))
ggsave("phrag_cover_biomass_model_means_tog.jpeg", width =800, height = 1050, units = c("px"))
##Native cover graphs ####
e <- ggplot(data = data1, aes(x = Phrag_Presence, y = response,
color = Phrag_Presence)) +
geom_point(size=2) +
geom_errorbar(aes(ymin = (response - SE),
ymax = (response+SE)),
width=0, size=0.5) +
labs(x="Presence of *P.australis*", y = "Model Predicted Proportional Native Cover",
title = "(a)") +
ylim(0, 1) +
geom_text(aes(label = .group,  y = response),
nudge_x = 0.1, color = "black") +
theme(axis.title.x = ggtext::element_markdown(),
plot.title = element_text(size = 9),
legend.position = "none") +
scale_color_manual(values = color1)
f <- ggplot(data = data2, aes(x = reorder(Species,response), y = response, color = Density)) +
geom_point(size=2) +
geom_errorbar(aes(ymin = (response - SE),
ymax = (response+SE)),
width=0, size=0.5) +
labs(x="Species", y = "Model Predicted Proportional Native Cover",
title = '(b)') +
ylim(0, 1) +
geom_text(aes(label = group_list,
vjust = .9, hjust = "left"),
nudge_x = .15,
check_overlap = TRUE,
color = "black") +
theme(axis.text.x = element_text(angle = 45, hjust = 0.9),
axis.title.y = ggtext::element_markdown(),
plot.title = element_text(size = 9)) +
scale_color_manual(values = color2)
e + f
#Native cover ####
mdf <- greenhouse %>%
dplyr::filter(!is.na(Density),
Date_Cleaned == "2022-05-16",
Species != "JUTO" & Species != "JUGE"  & Species != "SCAM" & Species != "BOMA"& Species != "SYCI")
mdf$Cover.Native[mdf$Cover.Native == 0] <- 0.005 #make 0s a trace amount - could be half the smallest amount
mdf$Phrag_Presence <- as.character(mdf$Phrag_Presence)
mdf$Phrag_Presence[mdf$Phrag_Presence == "W"] <- "Present"
mdf$Phrag_Presence[mdf$Phrag_Presence == "WO"] <- "Absent"
mdf$Phrag_Presence <- as.factor(mdf$Phrag_Presence)
mdf$Density <- as.character(mdf$Density)
mdf$Density[mdf$Density == "H"] <- "High"
mdf$Density[mdf$Density == "L"] <- "Low"
mdf$Density <- as.factor(mdf$Density)
#for graphing
color1 <- c("orange", "purple4")
color2 <- c("darkblue", "red3")
mdf$Density <- as.character(mdf$Density)
mdf$Density[mdf$Density == "H"] <- "High"
mdf$Density[mdf$Density == "L"] <- "Low"
mdf$Density <- as.factor(mdf$Density)
mdf.m1<- glmmTMB(Cover.Native ~ Phrag_Presence * Density * Species  #* for interaction
+ (1|Block),
data = mdf,
family = beta_family)
##phrag presence ####
emm <- emmeans(mdf.m1, pairwise ~ Phrag_Presence, adjust = "tukey", type = "response")
data1 <- multcomp::cld(emm$emmeans, alpha = 0.1, Letters = letters)
##species by density ####
emm <- emmeans(mdf.m1, pairwise ~ Species * Density, adjust = "tukey", type = "response")
data2 <- multcomp::cld(emm$emmeans, alpha = 0.1, Letters = letters)
##Native cover graphs ####
e <- ggplot(data = data1, aes(x = Phrag_Presence, y = response,
color = Phrag_Presence)) +
geom_point(size=2) +
geom_errorbar(aes(ymin = (response - SE),
ymax = (response+SE)),
width=0, size=0.5) +
labs(x="Presence of *P.australis*", y = "Model Predicted Proportional Native Cover",
title = "(a)") +
ylim(0, 1) +
geom_text(aes(label = .group,  y = response),
nudge_x = 0.1, color = "black") +
theme(axis.title.x = ggtext::element_markdown(),
plot.title = element_text(size = 9),
legend.position = "none") +
scale_color_manual(values = color1)
f <- ggplot(data = data2, aes(x = reorder(Species,response), y = response, color = Density)) +
geom_point(size=2) +
geom_errorbar(aes(ymin = (response - SE),
ymax = (response+SE)),
width=0, size=0.5) +
labs(x="Species", y = "Model Predicted Proportional Native Cover",
title = '(b)') +
ylim(0, 1) +
geom_text(aes(label = group_list,
vjust = .9, hjust = "left"),
nudge_x = .15,
check_overlap = TRUE,
color = "black") +
theme(axis.text.x = element_text(angle = 45, hjust = 0.9),
axis.title.y = ggtext::element_markdown(),
plot.title = element_text(size = 9)) +
scale_color_manual(values = color2)
e + f
load("main_dfs.RData")
library(tidyverse)
library(glmmTMB) #allows us to use a beta distribution
library(DHARMa)
library(emmeans)
library(car)
library(multcompView)
library(gridExtra)
library(patchwork)
greenhouse$Density <- as.factor(greenhouse$Density)
greenhouse$Phrag_Presence <- as.factor(greenhouse$Phrag_Presence)
greenhouse$Species <- as.factor(greenhouse$Species)
options(contrasts = c("contr.sum", "contr.poly"))
#for graphing
color1 <- c("orange", "purple4")
color2 <- c("darkblue", "red3")
#Native cover ####
mdf <- greenhouse %>%
dplyr::filter(!is.na(Density),
Date_Cleaned == "2022-05-16",
Species != "JUTO" & Species != "JUGE"  & Species != "SCAM" & Species != "BOMA"& Species != "SYCI")
mdf$Cover.Native[mdf$Cover.Native == 0] <- 0.005 #make 0s a trace amount - could be half the smallest amount
mdf$Phrag_Presence <- as.character(mdf$Phrag_Presence)
mdf$Phrag_Presence[mdf$Phrag_Presence == "W"] <- "Present"
mdf$Phrag_Presence[mdf$Phrag_Presence == "WO"] <- "Absent"
mdf$Phrag_Presence <- as.factor(mdf$Phrag_Presence)
mdf$Density <- as.character(mdf$Density)
mdf$Density[mdf$Density == "H"] <- "High"
mdf$Density[mdf$Density == "L"] <- "Low"
mdf$Density <- as.factor(mdf$Density)
mdf.m1<- glmmTMB(Cover.Native ~ Phrag_Presence * Density * Species  #* for interaction
+ (1|Block),
data = mdf,
family = beta_family)
##phrag presence ####
emm <- emmeans(mdf.m1, pairwise ~ Phrag_Presence, adjust = "tukey", type = "response")
data1 <- multcomp::cld(emm$emmeans, alpha = 0.1, Letters = letters)
##species by density ####
emm <- emmeans(mdf.m1, pairwise ~ Species * Density, adjust = "tukey", type = "response")
data2 <- multcomp::cld(emm$emmeans, alpha = 0.1, Letters = letters)
group_list <- c("a", "a", "ab", "ab",
"abc", "abc", "bcd", "cde",
"def", "def", "efg", "efg",
"fg", "gh", "hi", "hij",
"hij", "ij", "ij","ij",
"ij","ij","ij","ij","ij",
"j")
##Native cover graphs ####
e <- ggplot(data = data1, aes(x = Phrag_Presence, y = response,
color = Phrag_Presence)) +
geom_point(size=2) +
geom_errorbar(aes(ymin = (response - SE),
ymax = (response+SE)),
width=0, size=0.5) +
labs(x="Presence of *P.australis*", y = "Model Predicted Proportional Native Cover",
title = "(a)") +
ylim(0, 1) +
geom_text(aes(label = .group,  y = response),
nudge_x = 0.1, color = "black") +
theme(axis.title.x = ggtext::element_markdown(),
plot.title = element_text(size = 9),
legend.position = "none") +
scale_color_manual(values = color1)
f <- ggplot(data = data2, aes(x = reorder(Species,response), y = response, color = Density)) +
geom_point(size=2) +
geom_errorbar(aes(ymin = (response - SE),
ymax = (response+SE)),
width=0, size=0.5) +
labs(x="Species", y = "Model Predicted Proportional Native Cover",
title = '(b)') +
ylim(0, 1) +
geom_text(aes(label = group_list,
vjust = .9, hjust = "left"),
nudge_x = .15,
check_overlap = TRUE,
color = "black") +
theme(axis.text.x = element_text(angle = 45, hjust = 0.9),
axis.title.y = ggtext::element_markdown(),
plot.title = element_text(size = 9)) +
scale_color_manual(values = color2)
e + f
f <- ggplot(data = data2, aes(x = reorder(Species,response), y = response, color = Density)) +
geom_point(size=2) +
geom_errorbar(aes(ymin = (response - SE),
ymax = (response+SE)),
width=0, size=0.5) +
labs(x="Native Species Identity", y = "Model Predicted Proportional Native Cover",
title = '(b)') +
ylim(0, 1) +
geom_text(aes(label = group_list,
vjust = .9, hjust = "left"),
nudge_x = .15,
check_overlap = TRUE,
color = "black") +
theme(axis.text.x = element_text(angle = 45, hjust = 0.9),
axis.title.y = ggtext::element_markdown(),
plot.title = element_text(size = 9),
legend.position = "bottom") +
scale_color_manual(values = color2)
e + f
ggsave("native_cover_model_means_both.jpeg")
(e + f) + plot_layout(widths = c(1, 2))
ggsave("native_cover_model_means_both.jpeg")
(e + f) + plot_layout(widths = c(1, 1))
