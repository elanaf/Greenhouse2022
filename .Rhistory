width=0, size=0.5, position = position_jitter(seed = 1)) +
labs(x="", y = "Model Predicted <br> Proportional Cover", color = "Density") +
geom_text(aes(label = .group,  y = response),
position = position_jitter(seed=1),
color = "black", hjust = .1) +
ggtitle("EUMA") +
theme(axis.title.x = ggtext::element_markdown(),
axis.title.y = ggtext::element_markdown(),
plot.title = element_text(size = 9),
legend.position = "none") +
scale_color_manual(values = c("red3", "darkblue"), labels = c("High", "Low"))
###HENU####
mdf <- biomass %>%
filter(Species == "HENU", !is.na(Density))
mdf.m6 <- glmmTMB(sqrt(Native.Biomass) ~ Phrag_Presence * Density #* for interaction
+ (1|Block),
data = mdf,
family = gaussian
)
Anova(mdf.m6)
emm <- emmeans(mdf.m6, pairwise ~ Density * Phrag_Presence, adjust = "none", type = "response")
data6<- multcomp::cld(emm$emmeans, alpha = 0.1, Letters = letters)
data6
HENU_b <- ggplot(data = data6, aes(x = Phrag_Presence, y = response, color = Density)) +
geom_point(size=2, position = position_jitter(seed=2)) +
geom_errorbar(aes(ymin = (response - SE),
ymax = (response+SE)),
width=0, size=0.5, position = position_jitter(seed = 2)) +
labs(x="", y = "", color = "Density") +
geom_text(aes(label = .group,  y = response),
position = position_jitter(seed=2),
color = "black", hjust = .1) +
ggtitle("HENU") +
theme(axis.title.x = ggtext::element_markdown(),
plot.title = element_text(size = 9),
legend.position = "none") +
scale_color_manual(values = c("red3", "darkblue"), labels = c("High", "Low"))
###JUAR####
mdf <- biomass %>%
filter(Species == "JUAR", !is.na(Density))
mdf.m7 <- glmmTMB(sqrt(Native.Biomass) ~ Phrag_Presence * Density #* for interaction
+ (1|Block),
data = mdf,
family = gaussian
)
Anova(mdf.m7)
emm <- emmeans(mdf.m7, pairwise ~ Phrag_Presence * Density, adjust = "none", type = "response")
data7<- multcomp::cld(emm$emmeans, alpha = 0.1, Letters = letters)
data7
JUAR_b <- ggplot(data = data7, aes(x = Phrag_Presence, y = response, color = Density)) +
geom_point(size=2, position = position_jitter(seed=2)) +
geom_errorbar(aes(ymin = (response - SE),
ymax = (response+SE)),
width=0, size=0.5, position = position_jitter(seed = 2)) +
labs(x="", y = "", color = "Density") +
geom_text(aes(label = .group,  y = response),
position = position_jitter(seed=2),
color = "black", hjust = .1) +
ggtitle("JUAR") +
theme(axis.title.x = ggtext::element_markdown(),
plot.title = element_text(size = 9),
legend.position = "none") +
scale_color_manual(values = c("red3", "darkblue"), labels = c("High", "Low"))
###MUAS####
mdf <- biomass %>%
filter(Species == "MUAS", !is.na(Density))
mdf.m8 <- glmmTMB(sqrt(Native.Biomass) ~ Phrag_Presence * Density #* for interaction
+ (1|Block),
data = mdf,
family = gaussian
)
Anova(mdf.m8)
emm <- emmeans(mdf.m8, pairwise ~ Phrag_Presence*Density, adjust = "none", type = "response")
data8<- multcomp::cld(emm$emmeans, alpha = 0.1, Letters = letters)
data8
MUAS_b <- ggplot(data = data8, aes(x = Phrag_Presence, y = response, color = Density)) +
geom_point(size=2, position = position_jitter(seed=1)) +
geom_errorbar(aes(ymin = (response - SE),
ymax = (response+SE)),
width=0, size=0.5, position = position_jitter(seed = 1)) +
labs(x="", y = "", color = "Density") +
geom_text(aes(label = .group,  y = response),
position = position_jitter(seed=1),
color = "black", hjust = .1) +
ggtitle("MUAS") +
theme(axis.title.x = ggtext::element_markdown(),
plot.title = element_text(size = 9),
legend.position = "none") +
scale_color_manual(values = c("red3", "darkblue"), labels = c("High", "Low"))
###PUNU####
mdf <- biomass %>%
filter(Species == "PUNU", !is.na(Density))
mdf.m9 <- glmmTMB(sqrt(Native.Biomass) ~ Phrag_Presence * Density #* for interaction
+ (1|Block),
data = mdf,
family = gaussian
)
Anova(mdf.m9)
emm <- emmeans(mdf.m9, pairwise ~ Density*Phrag_Presence, adjust = "none", type = "response")
data9<- multcomp::cld(emm$emmeans, alpha = 0.1, Letters = letters)
data9
PUNU_b <- ggplot(data = data9, aes(x = Phrag_Presence, y = response, color = Density)) +
geom_point(size=2, position = position_jitter(seed=2)) +
geom_errorbar(aes(ymin = (response - SE),
ymax = (response+SE)),
width=0, size=0.5, position = position_jitter(seed = 2)) +
labs(x="", y = "", color = "Density") +
geom_text(aes(label = .group,  y = response),
position = position_jitter(seed=2),
color = "black", hjust = .1) +
ggtitle("PUNU") +
theme(axis.title.x = ggtext::element_markdown(),
plot.title = element_text(size = 9),
legend.position = "none") +
scale_color_manual(values = c("red3", "darkblue"), labels = c("High", "Low"))
###RUMA####
mdf <- biomass %>%
filter(Species == "RUMA", !is.na(Density))
mdf.m10<- glmmTMB(sqrt(Native.Biomass) ~ Phrag_Presence * Density #* for interaction
+ (1|Block),
data = mdf,
family = gaussian
)
Anova(mdf.m10)
emm <- emmeans(mdf.m10, pairwise ~ Density*Phrag_Presence, adjust = "none", type = "response")
data10<- multcomp::cld(emm$emmeans, alpha = 0.1, Letters = letters)
data10
RUMA_b <- ggplot(data = data10, aes(x = Phrag_Presence, y = response, color = Density)) +
geom_point(size=2, position = position_jitter(seed=2)) +
geom_errorbar(aes(ymin = (response - SE),
ymax = (response+SE)),
width=0, size=0.5, position = position_jitter(seed = 2)) +
labs(x="", y = "", color = "Density") +
geom_text(aes(label = .group,  y = response),
position = position_jitter(seed=2),
color = "black", hjust = .1) +
ggtitle("RUMA") +
theme(axis.title.x = ggtext::element_markdown(),
plot.title = element_text(size = 9),
legend.position = "none") +
scale_color_manual(values = c("red3", "darkblue"), labels = c("High", "Low"))
###SCAC####
mdf <- biomass %>%
filter(Species == "SCAC", !is.na(Density))
mdf.m11 <- glmmTMB(sqrt(Native.Biomass) ~ Phrag_Presence * Density #* for interaction
+ (1|Block),
data = mdf,
family = gaussian
)
Anova(mdf.m11)
emm <- emmeans(mdf.m11, pairwise ~ Density*Phrag_Presence, adjust = "none", type = "response")
data11<- multcomp::cld(emm$emmeans, alpha = 0.1, Letters = letters)
data11
SCAC_b <- ggplot(data = data11, aes(x = Phrag_Presence, y = response, color = Density)) +
geom_point(size=2, position = position_jitter(seed=5)) +
geom_errorbar(aes(ymin = (response - SE),
ymax = (response+SE)),
width=0, size=0.5, position = position_jitter(seed = 5)) +
labs(x="", y = "", color = "Density") +
geom_text(aes(label = .group,  y = response),
position = position_jitter(seed=5),
color = "black", hjust = .1) +
ggtitle("SCAC") +
theme(axis.title.x = ggtext::element_markdown(),
plot.title = element_text(size = 9),
legend.position = "none") +
scale_color_manual(values = c("red3", "darkblue"), labels = c("High", "Low"))
###SCPU####
mdf <- biomass %>%
filter(Species == "SCPU", !is.na(Density))
mdf.m12 <- glmmTMB(sqrt(Native.Biomass) ~ Phrag_Presence * Density #* for interaction
+ (1|Block),
data = mdf,
family = gaussian
)
Anova(mdf.m12)
emm <- emmeans(mdf.m12, pairwise ~ Phrag_Presence*Density, adjust = "none", type = "response")
data12 <- multcomp::cld(emm$emmeans, alpha = 0.1, Letters = letters)
data12
SCPU_b <- ggplot(data = data12, aes(x = Phrag_Presence, y = response, color = Density)) +
geom_point(size=2, position = position_jitter(seed=1)) +
geom_errorbar(aes(ymin = (response - SE),
ymax = (response+SE)),
width=0, size=0.5, position = position_jitter(seed = 1)) +
labs(x="", y = "", color = "Density") +
geom_text(aes(label = .group,  y = response),
position = position_jitter(seed=1),
color = "black", hjust = .1) +
ggtitle("SCPU") +
theme(axis.title.x = ggtext::element_markdown(),
plot.title = element_text(size = 9),
legend.position = "none") +
scale_color_manual(values = c("red3", "darkblue"), labels = c("High", "Low"))
###SOCA####
mdf <- biomass %>%
filter(Species == "SOCA", !is.na(Density))
mdf.m13 <- glmmTMB(sqrt(Native.Biomass) ~ Phrag_Presence * Density #* for interaction
+ (1|Block),
data = mdf,
family = gaussian
)
Anova(mdf.m13)
emm <- emmeans(mdf.m13, pairwise ~ Phrag_Presence*Density, adjust = "none", type = "response")
data13 <- multcomp::cld(emm$emmeans, alpha = 0.1, Letters = letters)
data13
SOCA_b <- ggplot(data = data13, aes(x = Phrag_Presence, y = response, color = Density)) +
geom_point(size=2, position = position_jitter(seed=1)) +
geom_errorbar(aes(ymin = (response - SE),
ymax = (response+SE)),
width=0, size=0.5, position = position_jitter(seed = 1)) +
labs(x="*P. australis* Presence", y = "", color = "Density") +
geom_text(aes(label = .group,  y = response),
position = position_jitter(seed=1),
color = "black", hjust = .1) +
ggtitle("SOCA") +
theme(axis.title.x = ggtext::element_markdown(),
plot.title = element_text(size = 9)) +
scale_color_manual(values = c("red3", "darkblue"), labels = c("High", "Low"))
###ALL TOGETHER####
BICE_b + DISP_b + EPCI_b + EUOC_b + EUMA_b + HENU_b +
JUAR_b + MUAS_b + PUNU_b + RUMA_b + SCAC_b + SCPU_b + SOCA_b +
guide_area() +
plot_layout(guides = "collect")
EUMA_b <- ggplot(data = data5, aes(x = Phrag_Presence, y = response, color = Density)) +
geom_point(size=2, position = position_jitter(seed=1)) +
geom_errorbar(aes(ymin = (response - SE),
ymax = (response+SE)),
width=0, size=0.5, position = position_jitter(seed = 1)) +
labs(x="", y = "Model Predicted <br> Biomass (g)", color = "Density") +
geom_text(aes(label = .group,  y = response),
position = position_jitter(seed=1),
color = "black", hjust = .1) +
ggtitle("EUMA") +
theme(axis.title.x = ggtext::element_markdown(),
axis.title.y = ggtext::element_markdown(),
plot.title = element_text(size = 9),
legend.position = "none") +
scale_color_manual(values = c("red3", "darkblue"), labels = c("High", "Low"))
###ALL TOGETHER####
b <- (BICE_b + DISP_b + EPCI_b + EUOC_b + EUMA_b + HENU_b +
JUAR_b + MUAS_b + PUNU_b + RUMA_b + SCAC_b + SCPU_b + SOCA_b +
guide_area() +
plot_layout(guides = "collect") )
b
###ALL TOGETHER####
c <- (BICE + DISP + EPCI + EUOC + EUMA + HENU +
JUAR + MUAS + PUNU + RUMA + SCAC + SCPU + SOCA +
guide_area() +
plot_layout(guides = "collect") )
##All all together####
c / b +
plot_annotation(tag_levels = 'A') &
theme(plot.tag = element_text(size = 9))
ggsave("model-means_two-way_cover-biomass.jpeg"
)
ggsave("model-means_two-way_cover-biomass.jpeg", height = 1000, width = 1000
)
ggsave("model-means_two-way_cover-biomass.jpeg", height = 1000, width = 1000, units = px,
)
ggsave("model-means_two-way_cover-biomass.jpeg", height = 1000, width = 1000, units = "px")
BICE_b + DISP_b + EPCI_b + EUOC_b + EUMA_b + HENU_b +
JUAR_b + MUAS_b + PUNU_b + RUMA_b + SCAC_b + SCPU_b + SOCA_b +
guide_area() +
plot_layout(guides = "collect")
BICE_b + DISP_b + EPCI_b + EUOC_b + EUMA_b + HENU_b +
JUAR_b + MUAS_b + PUNU_b + RUMA_b + SCAC_b + SCPU_b + SOCA_b +
guide_area() +
plot_layout(guides = "collect")
ggsave("two-way_model-means_biomass.jpeg")
###ALL TOGETHER####
BICE + DISP + EPCI + EUOC + EUMA + HENU +
JUAR + MUAS + PUNU + RUMA + SCAC + SCPU + SOCA +
guide_area() +
plot_layout(guides = "collect")
ggsave("two-way_model-means_cover.jpeg")
load("main_dfs.RData")
library(tidyverse)
library(glmmTMB) #allows us to use a beta distribution
library(DHARMa)
library(emmeans)
library(car)
library(multcompView)
library(gridExtra)
library(patchwork)
greenhouse$Density <- as.factor(greenhouse$Density)
greenhouse$Phrag_Presence <- as.factor(greenhouse$Phrag_Presence)
greenhouse$Species <- as.factor(greenhouse$Species)
options(contrasts = c("contr.sum", "contr.poly"))
color1 <- c("orange", "purple4")
color2 <- c("darkblue", "red3")
#Native cover ####
mdf <- greenhouse %>%
dplyr::filter(!is.na(Density),
Date_Cleaned == "2022-05-16",
Species != "JUTO" & Species != "JUGE"  & Species != "SCAM" & Species != "BOMA"& Species != "SYCI")
mdf$Cover.Native[mdf$Cover.Native == 0] <- 0.005 #make 0s a trace amount - could be half the smallest amount
mdf$Phrag_Presence <- as.character(mdf$Phrag_Presence)
mdf$Phrag_Presence[mdf$Phrag_Presence == "W"] <- "Present"
mdf$Phrag_Presence[mdf$Phrag_Presence == "WO"] <- "Absent"
mdf$Phrag_Presence <- as.factor(mdf$Phrag_Presence)
mdf$Density <- as.character(mdf$Density)
mdf$Density[mdf$Density == "H"] <- "High"
mdf$Density[mdf$Density == "L"] <- "Low"
mdf$Density <- as.factor(mdf$Density)
mdf.m1<- glmmTMB(Cover.Native ~ Phrag_Presence * Density * Species  #* for interaction
+ (1|Block),
data = mdf,
family = beta_family)
##phrag presence ####
emm <- emmeans(mdf.m1, pairwise ~ Phrag_Presence, adjust = "tukey", type = "response")
data1 <- multcomp::cld(emm$emmeans, alpha = 0.1, Letters = letters)
data1
ggplot(data = data1, aes(x = Phrag_Presence, y = response * 100,
color = Phrag_Presence)) +
geom_point(size=2) +
geom_errorbar(aes(ymin = 100*(response - SE),
ymax = 100*(response+SE)),
width=0, size=0.5) +
labs(x="Presence of *Phragmites*", y = "Model Predicted Native Cover (%)",
title = "(a)") +
geom_text(aes(label = .group,  y = response * 100),
nudge_x = 0.1, color = "black") +
theme(axis.title.x = ggtext::element_markdown(),
plot.title = element_text(size = 9),
legend.position = "none") +
scale_color_manual(values = color1)
##species by density ####
emm <- emmeans(mdf.m1, pairwise ~ Species * Density, adjust = "tukey", type = "response")
data2 <- multcomp::cld(emm$emmeans, alpha = 0.1, Letters = letters)
data2
data2$.group
group_list <- c("a", "a", "ab", "ab",
"abc", "abc", "bcd", "cde",
"def", "def", "efg", "efg",
"fg", "gh", "hi", "hij",
"hij", "ij", "ij","ij",
"ij","ij","ij","ij","ij",
"j")
ggplot(data = data2, aes(x = reorder(Species,response), y = response * 100, color = Density)) +
geom_point(size=2) +
geom_errorbar(aes(ymin = 100*(response - SE),
ymax = 100*(response+SE)),
width=0, size=0.5) +
labs(x="Species", y = "Model Predicted Native Cover (%)",
title = '(b)') +
geom_text(aes(label = group_list,
vjust = .9, hjust = "left"),
nudge_x = .15,
check_overlap = TRUE,
color = "black") +
theme(axis.text.x = element_text(angle = 45, hjust = 0.9),
axis.title.y = ggtext::element_markdown(),
plot.title = element_text(size = 9)) +
scale_color_manual(values = color2)
##Native cover graphs ####
e <- ggplot(data = data1, aes(x = Phrag_Presence, y = response,
color = Phrag_Presence)) +
geom_point(size=2) +
geom_errorbar(aes(ymin = (response - SE),
ymax = (response+SE)),
width=0, size=0.5) +
labs(x="Presence of *P.australis*", y = "Model Predicted Proportional Native Cover",
title = "(a)") +
ylim(0, 1) +
geom_text(aes(label = .group,  y = response),
nudge_x = 0.1, color = "black") +
theme(axis.title.x = ggtext::element_markdown(),
plot.title = element_text(size = 9),
legend.position = "none") +
scale_color_manual(values = color1)
f <- ggplot(data = data2, aes(x = reorder(Species,response), y = response, color = Density)) +
geom_point(size=2, position = position_jitter(seed=1)) +
geom_errorbar(aes(ymin = (response - SE),
ymax = (response+SE)),
width=0, size=0.5, position = position_jitter(seed=1)) +
labs(x="Native Species Identity", y = "Model Predicted Proportional Native Cover",
title = '(b)') +
ylim(0, 1) +
geom_text(aes(label = group_list,
vjust = .9, hjust = "left"),
nudge_x = .15,
check_overlap = TRUE,
color = "black") +
theme(axis.text.x = element_text(angle = 45, hjust = 0.9),
axis.title.y = ggtext::element_markdown(),
plot.title = element_text(size = 9),
legend.position = "bottom") +
scale_color_manual(values = color2)
(e + f) + plot_layout(widths = c(1, 2))
f <- ggplot(data = data2, aes(x = reorder(Species,response), y = response, color = Density)) +
geom_point(size=2, position = position_jitter(seed=1)) +
geom_errorbar(aes(ymin = (response - SE),
ymax = (response+SE)),
width=0, size=0.5, position = position_jitter(seed=1)) +
labs(x="Native Species Identity", y = "Model Predicted Proportional Native Cover",
title = '(b)') +
ylim(0, 1) +
geom_text(aes(label = group_list,
vjust = .9, hjust = "left"),
nudge_x = .15,
check_overlap = TRUE,
color = "black", position = position_jitter(seed=1)) +
theme(axis.text.x = element_text(angle = 45, hjust = 0.9),
axis.title.y = ggtext::element_markdown(),
plot.title = element_text(size = 9),
legend.position = "bottom") +
scale_color_manual(values = color2)
f <- ggplot(data = data2, aes(x = reorder(Species,response), y = response, color = Density)) +
geom_point(size=2, position = position_jitter(seed=1)) +
geom_errorbar(aes(ymin = (response - SE),
ymax = (response+SE)),
width=0, size=0.5, position = position_jitter(seed=1)) +
labs(x="Native Species Identity", y = "Model Predicted Proportional Native Cover",
title = '(b)') +
ylim(0, 1) +
geom_text(aes(label = group_list,
vjust = .9, hjust = "left"),
check_overlap = TRUE,
color = "black", position = position_jitter(seed=1)) +
theme(axis.text.x = element_text(angle = 45, hjust = 0.9),
axis.title.y = ggtext::element_markdown(),
plot.title = element_text(size = 9),
legend.position = "bottom") +
scale_color_manual(values = color2)
(e + f) + plot_layout(widths = c(1, 2))
ggsave("native_cover_model_means_both.jpeg")
library(tidyverse)
library(patchwork)
load("main_dfs.RData")
## Native cover ####
#how does native cover change over time by density and presence of phrag
cover_native <- greenhouse %>%
filter(Species != "PHAU") %>%
ggplot(aes(x = Date_Cleaned, y = Cover.Native, shape = Phrag_Presence, color = Density)) +
#using the means of the blocks
stat_summary(aes(group = interaction(Density, Phrag_Presence)),
fun = mean, geom = "point", size = 2) +
#error bars added
stat_summary(aes(group = interaction(Density, Phrag_Presence), width = 0),
fun.data = mean_se, geom = "errorbar") +
#add a line to connect the dates
stat_summary(aes(group = interaction(Density, Phrag_Presence)),
fun = mean, geom = "line") +
facet_wrap(~Species) +
theme(legend.position = 'bottom',
axis.text.x = element_text(angle = 45, hjust = 0.9),
legend.title =ggtext::element_markdown(size = 10),
legend.text = ggtext::element_markdown(size = 9)) +
labs(x = "Date", y = "Proportional Native Cover", color = "Density", shape = "*P.australis* Presence") +
scale_color_manual(values = c("red3", "darkblue"), labels = c("High", "Low")) + #change the legend labels
scale_shape(labels = c("Present", "Absent"))
cover_native
## Native cover ####
#how does native cover change over time by density and presence of phrag
cover_native <- greenhouse %>%
filter(Species != "PHAU") %>%
ggplot(aes(x = Date_Cleaned, y = Cover.Native, shape = Phrag_Presence, color = Density)) +
#using the means of the blocks
stat_summary(aes(group = interaction(Density, Phrag_Presence)),
fun = mean, geom = "point", size = 2, position = position_jitter(seed=1)) +
#error bars added
stat_summary(aes(group = interaction(Density, Phrag_Presence), width = 0),
fun.data = mean_se, geom = "errorbar", position = position_jitter(seed=1)) +
#add a line to connect the dates
stat_summary(aes(group = interaction(Density, Phrag_Presence)),
fun = mean, geom = "line", position = position_jitter(seed=1)) +
facet_wrap(~Species) +
theme(legend.position = 'bottom',
axis.text.x = element_text(angle = 45, hjust = 0.9),
legend.title =ggtext::element_markdown(size = 10),
legend.text = ggtext::element_markdown(size = 9)) +
labs(x = "Date", y = "Proportional Native Cover", color = "Density", shape = "*P.australis* Presence") +
scale_color_manual(values = c("red3", "darkblue"), labels = c("High", "Low")) + #change the legend labels
scale_shape(labels = c("Present", "Absent"))
cover_native
#manually reorder species so they go from smallest to largest biomass
biomass %>%
group_by(Species) %>%
mutate(mean = mean(Native.Biomass, na.rm = TRUE)) %>%
arrange(mean) %>%
View()
biomass <- biomass %>%
mutate(Species = factor(Species,
levels = c("SCAM", "JUTO", "BOMA",
"JUGE", "SCPU", "SCAC", "JUAR",
"SOCA", "DISP", "EUOC",
"PUNU", "EUMA", "SYCI", "MUAS",
"EPCI", "HENU", 'RUMA', 'BICE', 'PHAU')))
#change order of phrag presence and also labels
biomass$Phrag_Presence <- factor(biomass$Phrag_Presence, levels = c("WO", "W"),
labels = c("Absent", "Present")
)
biomass_native <- biomass %>%
filter(Species != "PHAU") %>%
ggplot(aes(x = Species,
y = Native.Biomass, color = Density)) +
#using the means of the blocks
stat_summary(aes(group = interaction(Species, Density)),
fun = mean, geom = "point", size = 2, position = position_jitter(seed=1)) +
#error bars added
stat_summary(aes(group = interaction(Species, Density), width = 0),
fun.data = mean_se, geom = "errorbar", position = position_jitter(seed=1)) +
labs(x = "Native Species Identity", y = "Native Biomass (g)", color = "Density") +
facet_wrap(~Phrag_Presence) +
scale_color_manual(labels = c('High', 'Low'), values = c("red3", "darkblue")) + #change the legend labels
theme(legend.title = ggtext::element_markdown(),
legend.text = element_text(),#change legend size
axis.text.x = element_text(angle = 45, hjust = 0.9),
legend.position = "bottom")
biomass_native
ggsave(filename = "biomass_native.jpeg",
device = "jpeg")
