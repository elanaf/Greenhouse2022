filter(Phrag_Presence == "W") %>%
ggplot(aes(x = Species,
y = Phrag.Biomass, color = Density))
biomass %>%
filter(Phrag_Presence == "W") %>%
ggplot(aes(x = Species,
y = Phrag.Biomass, color = Density)) +
#using the means of the blocks
stat_summary(aes(group = Density),
fun = mean, geom = "point", size = 2, shape = 1)
biomass %>%
filter(Phrag_Presence == "W") %>%
ggplot(aes(x = Species,
y = Phrag.Biomass, color = Density)) +
#using the means of the blocks
stat_summary(aes(group = interaction(Species, Density)),
fun = mean, geom = "point", size = 2, shape = 1) +
#error bars added
stat_summary(aes(group = interaction(Species, Density), width = .5),
fun.data = mean_se, geom = "errorbar") +
labs(x = "Species", y = "*Phragmites* Biomass (g)", color = "Density")
biomass %>%
filter(Phrag_Presence == "W") %>%
ggplot(aes(x = Species,
y = Phrag.Biomass, color = Density)) +
#using the means of the blocks
stat_summary(aes(group = interaction(Species, Density)),
fun = mean, geom = "point", size = 2, shape = 1)
biomass %>%
filter(Phrag_Presence == "W") %>%
ggplot(aes(x = Species,
y = Phrag.Biomass, color = Density)) +
#using the means of the blocks
stat_summary(aes(group = interaction(Species, Density)),
fun = mean, geom = "point", size = 2, shape = 1) +
#error bars added
stat_summary(aes(group = interaction(Species, Density), width = .5),
fun.data = mean_se, geom = "errorbar")
library(tidyverse)
load("main_dfs.RData")
## Phrag biomass ####
#how does phrag biomass change by density
biomass$Species <- factor(biomass$Species, #make PHAU last
levels = c("BICE", 'BOMA', 'DISP', 'EPCI', 'EUMA',
'EUOC', 'HENU', 'JUAR', 'JUGE', 'JUTO',
'MUAS', 'PUNU', 'RUMA', 'SCAC', 'SCAM',
'SCPU', 'SOCA', 'SYCI', 'PHAU'))
biomass %>%
filter(Species != "PHAU") %>%
ggplot(aes(x = Species,
y = Native.Biomass, color = Density)) +
#using the means of the blocks
stat_summary(aes(group = interaction(Species, Density)),
fun = mean, geom = "point", size = 2, shape = 1) +
#error bars added
stat_summary(aes(group = interaction(Species, Density), width = .5),
fun.data = mean_se, geom = "errorbar") +
labs(x = "Species", y = "Native Biomass (g)", color = "Density") +
facet_wrap(~Phrag_Presence) +
scale_color_hue(labels = c('High', 'Low')) + #change the legend labels
theme(legend.title = ggtext::element_markdown(),
legend.text = element_text(),#change legend size
axis.text.x = element_text(angle = 45, hjust = 0.9))
biomass_phrag <- biomass %>%
filter(Phrag_Presence == "W") %>%
ggplot(aes(x = Species,
y = Phrag.Biomass, color = Density)) +
#using the means of the blocks
stat_summary(aes(group = interaction(Species, Density)),
fun = mean, geom = "point", size = 2, shape = 1) +
#error bars added
stat_summary(aes(group = interaction(Species, Density), width = .5),
fun.data = mean_se, geom = "errorbar") +
labs(x = "Species", y = "*Phragmites* Biomass (g)", color = "Density")
biomass_phrag
biomass_phrag <- biomass %>%
filter(Phrag_Presence == "W") %>%
ggplot(aes(x = Species,
y = Phrag.Biomass, color = Density)) +
#using the means of the blocks
stat_summary(aes(group = interaction(Species, Density)),
fun = mean, geom = "point", size = 2, shape = 1) +
#error bars added
stat_summary(aes(group = interaction(Species, Density), width = .5),
fun.data = mean_se, geom = "errorbar") +
labs(x = "Species", y = "*Phragmites* Biomass (g)", color = "Density") +
scale_color_hue(labels = c('High', 'Low', "Control"))+ #change the legend labels
theme(axis.title.y = ggtext::element_markdown(),
axis.text.x = element_text(angle = 45, hjust = 0.9))
biomass_phrag
#manually change order of species because PHAU needs to be last
biomass %>%
group_by(Species) %>%
mutate(mean = mean(Phrag.Biomass, na.rm = TRUE)) %>%
arrange(mean) %>%
View()
biomass$Species <- factor(biomass$Species,
levels = c("HENU", 'RUMA', 'BICE', 'EPCI', 'EUOC',
'MUAS', 'SYCI', 'EUMA', 'DISP', 'SOCA',
'JUTO', 'JUGE', 'PUNU', 'BOMA', 'SCPU',
'SCAC', 'SCAM', 'JUAR', 'PHAU'))
biomass_phrag <- biomass %>%
filter(Phrag_Presence == "W") %>%
ggplot(aes(x = Species,
y = Phrag.Biomass, color = Density)) +
#using the means of the blocks
stat_summary(aes(group = interaction(Species, Density)),
fun = mean, geom = "point", size = 2, shape = 1) +
#error bars added
stat_summary(aes(group = interaction(Species, Density), width = .5),
fun.data = mean_se, geom = "errorbar") +
labs(x = "Species", y = "*Phragmites* Biomass (g)", color = "Density") +
scale_color_hue(labels = c('High', 'Low', "Control"))+ #change the legend labels
theme(axis.title.y = ggtext::element_markdown(),
axis.text.x = element_text(angle = 45, hjust = 0.9))
biomass_phrag
ggsave(filename = "biomass_phrag.jpeg",
device = "jpeg")
##New graphs that show how phrag changes over time compared to what is expected
#create a new, smaller dataset to work with
final.data <- greenhouse %>%
filter(Date == "2022-05-16" | Date == "2022-05-17") %>%
select(Tub, Species, Density, Block, Phrag_Presence,
Date_Cleaned, Cover.Native, Cover.Phrag,
Height.Native, Height.Phrag) #only select the columns I will need to work with
#make different datasets based on block to make calculations easier
final.data.b1 <- greenhouse %>%
filter(Date == "2022-05-16" | Date == "2022-05-17",#only the last sampling date
Phrag_Presence == "W", #only the ones that had phrag grow with them
Block == 1) %>% #only block 1
select(Tub, Species, Density, Block,
Date_Cleaned, Cover.Native, Cover.Phrag,
Height.Native, Height.Phrag) #only select the columns I will need to work with
final.data.b2 <- greenhouse %>%
filter(Date == "2022-05-16" | Date == "2022-05-17",#only the last sampling date
Phrag_Presence == "W", #only the ones that had phrag grow with them
Block == 2) %>% #only block 1
select(Tub, Species, Density, Block,
Date_Cleaned, Cover.Native, Cover.Phrag,
Height.Native, Height.Phrag) #only select the columns I will need to work with
final.data.b3 <- greenhouse %>%
filter(Date == "2022-05-16" | Date == "2022-05-17",#only the last sampling date
Phrag_Presence == "W", #only the ones that had phrag grow with them
Block == 3) %>% #only block 3
select(Tub, Species, Density, Block,
Date_Cleaned, Cover.Native, Cover.Phrag,
Height.Native, Height.Phrag) #only select the columns I will need to work with
#mutate them to have the reduction value, based on the control in each block
#first, get the phrag height and cover values of the control
control.matrix <- final.data %>%
filter(Species == "PHAU")
height.control.1 <- control.matrix$Height.Phrag[1]
cover.control.1 <- control.matrix$Cover.Phrag[1]
height.control.2 <- control.matrix$Height.Phrag[2]
cover.control.2 <- control.matrix$Cover.Phrag[2]
height.control.3 <- control.matrix$Height.Phrag[3]
cover.control.3 <- control.matrix$Cover.Phrag[3]
#now mutate the block datasets to get the reduction value
final.data.b1 <- final.data.b1 %>%
mutate(P.Height.Red =
(final.data.b1$Height.Phrag - height.control.1)/height.control.1,
P.Cover.Red =
(final.data.b1$Cover.Phrag - cover.control.1)/cover.control.1)
final.data.b2 <- final.data.b2 %>%
mutate(P.Height.Red =
(final.data.b2$Height.Phrag - height.control.2)/height.control.2,
P.Cover.Red =
(final.data.b2$Cover.Phrag - cover.control.2)/cover.control.2)
final.data.b3 <- final.data.b3 %>%
mutate(P.Height.Red =
(final.data.b3$Height.Phrag - height.control.3)/height.control.3,
P.Cover.Red =
(final.data.b3$Cover.Phrag - cover.control.3)/cover.control.3)
#combine back into 1 dataset to graph
combine1 <- bind_rows(final.data.b1, final.data.b2)
final.data.red <- bind_rows(combine1, final.data.b3)
final.data.red <- final.data.red %>%
mutate(Pos.Red = P.Cover.Red * -1) #to get a positive value
#and now for biomass
#make different datasets based on block to make calculations easier
biomass.b1 <- biomass %>%
filter(Phrag_Presence == "W", #only the ones that had phrag grow with them
Block == 1) %>% #only block 1
select(Tub, Species, Density, Block,
Phrag.Biomass) #only select the columns I will need to work with
biomass.b2 <- biomass %>%
filter(Phrag_Presence == "W", #only the ones that had phrag grow with them
Block == 2) %>% #only block 1
select(Tub, Species, Density, Block,
Phrag.Biomass) #only select the columns I will need to work with
biomass.b3 <- biomass %>%
filter(Phrag_Presence == "W", #only the ones that had phrag grow with them
Block == 3) %>% #only block 1
select(Tub, Species, Density, Block,
Phrag.Biomass) #only select the columns I will need to work with
#mutate them to have the reduction value, based on the control in each block
#first, get the phrag height and cover values of the control
control.matrix <- biomass %>%
filter(Species == "PHAU")
biomass.control.1 <- control.matrix$Phrag.Biomass[1]
biomass.control.2 <- control.matrix$Phrag.Biomass[2]
biomass.control.3 <- control.matrix$Phrag.Biomass[3]
#now mutate the block datasets to get the reduction value
biomass.b1 <- biomass.b1 %>%
mutate(P.Biomass.Red =
(biomass.b1$Phrag.Biomass - biomass.control.1)/biomass.control.1)
biomass.b2 <- biomass.b2 %>%
mutate(P.Biomass.Red =
(biomass.b2$Phrag.Biomass - biomass.control.2)/biomass.control.2)
biomass.b3 <- biomass.b3 %>%
mutate(P.Biomass.Red =
(biomass.b3$Phrag.Biomass - biomass.control.3)/biomass.control.3)
#combine back into 1 dataset to graph
combine1 <- bind_rows(biomass.b1, biomass.b2)
final.biomass.red <- bind_rows(combine1, biomass.b3)
final.biomass.red <- final.biomass.red %>%
mutate(Pos.Red = P.Biomass.Red*-1) #to make positive
#I need to calculate and manually reorder because NAs throwing off my graph
#final.data.red %>%
group_by(Species, Density) %>%
mutate(mean = mean(Pos.Red, na.rm = TRUE)) %>%
arrange(mean) %>%
View()
cover.red <- final.data.red %>%
filter(Species != "PHAU") %>%
mutate(Species = factor(Species,
levels = c("SCAM", "JUAR", "SCAC",
"JUGE", "SYCI", "MUAS", "PUNU",
"BOMA", "SOCA", "SCPU", "EUOC", "JUTO",
"DISP", "EUMA", "BICE", "EPCI",
"RUMA", "HENU"))) %>%
ggplot(aes(x = Species, y = Pos.Red, color = Density)) +
stat_summary(aes(group = Density),
fun = mean, geom = "point",
position = position_dodge(0.95)) +
stat_summary(aes(group = Density, width = .5),
fun.data = mean_se, geom = "errorbar",
position = position_dodge(0.95)) +
theme(axis.text.x = element_text(angle = 45, hjust = 0.9),
axis.title.y = ggtext::element_markdown()) +
labs(y = "Proportion Reduction in *Phragmites* Cover", x = "Species") +
scale_color_hue(labels = c('High', 'Low')) #change the legend labels
cover.red
ggsave(filename = "cover_reduction.jpeg",
device = "jpeg")
biomass.red <- final.biomass.red %>%
filter(Species != "PHAU") %>%
ggplot(aes(x = reorder(Species, Pos.Red), y = Pos.Red, color = Density)) +
stat_summary(aes(group = Density),
fun = mean, geom = "point",
position = position_dodge(0.95)) +
stat_summary(aes(group = Density, width = .5),
fun.data = mean_se, geom = "errorbar",
position = position_dodge(0.95)) +
theme(axis.text.x = element_text(angle = 45, hjust = 0.9),
axis.title.y = ggtext::element_markdown()) +
labs(y = "Proportion Reduction of *Phragmites* Biomass", x = "Species")+
scale_color_hue(labels = c('High', 'Low')) #change the legend labels
biomass.red
ggsave(filename = "biomass_reduction.jpeg",
device = "jpeg")
load("main_dfs.RData")
library(tidyverse)
library(glmmTMB) #allows us to use a beta distribution
library(DHARMa)
library(emmeans)
library(car)
library(multcompView)
library(gridExtra)
greenhouse$Density <- as.factor(greenhouse$Density)
greenhouse$Phrag_Presence <- as.factor(greenhouse$Phrag_Presence)
greenhouse$Species <- as.factor(greenhouse$Species)
options(contrasts = c("contr.sum", "contr.poly"))
#Native cover ####
mdf <- greenhouse %>%
dplyr::filter(!is.na(Density),
Date_Cleaned == "2022-05-16",
Species != "JUTO" & Species != "JUGE"  & Species != "SCAM" & Species != "BOMA"& Species != "SYCI")
mdf$Cover.Native[mdf$Cover.Native == 0] <- 0.005 #make 0s a trace amount - could be half the smallest amount
mdf$Phrag_Presence <- as.character(mdf$Phrag_Presence)
mdf$Phrag_Presence[mdf$Phrag_Presence == "W"] <- "Present"
mdf$Phrag_Presence[mdf$Phrag_Presence == "WO"] <- "Absent"
mdf$Phrag_Presence <- as.factor(mdf$Phrag_Presence)
mdf$Density <- as.character(mdf$Density)
mdf$Density[mdf$Density == "H"] <- "High"
mdf$Density[mdf$Density == "L"] <- "Low"
mdf$Density <- as.factor(mdf$Density)
mdf.m1<- glmmTMB(Cover.Native ~ Phrag_Presence * Density * Species  #* for interaction
+ (1|Block),
data = mdf,
family = beta_family)
##phrag presence ####
emm <- emmeans(mdf.m1, pairwise ~ Phrag_Presence, adjust = "tukey", type = "response")
data1 <- multcomp::cld(emm$emmeans, alpha = 0.05, Letters = letters)
data1
ggplot(data = data1, aes(x = Phrag_Presence, y = response * 100)) +
geom_point(size=2) +
geom_errorbar(aes(ymin = 100*(response - SE),
ymax = 100*(response+SE)),
width=0, size=0.5) +
labs(x="Presence of *Phragmites*", y = "Model predicted native cover (%)") +
geom_text(aes(label = .group,  y = response * 100),
nudge_x = 0.1) +
theme(axis.title.x = ggtext::element_markdown())
load("main_dfs.RData")
library(tidyverse)
library(glmmTMB) #allows us to use a beta distribution
library(DHARMa)
library(emmeans)
library(car)
library(multcompView)
library(gridExtra)
greenhouse$Density <- as.factor(greenhouse$Density)
greenhouse$Phrag_Presence <- as.factor(greenhouse$Phrag_Presence)
greenhouse$Species <- as.factor(greenhouse$Species)
options(contrasts = c("contr.sum", "contr.poly"))
mdf <- greenhouse %>%
dplyr::filter(!is.na(Density),
Date_Cleaned == "2022-05-16",
Species != "JUTO" & Species != "JUGE"  & Species != "SCAM" & Species != "BOMA"& Species != "SYCI")
mdf$Cover.Native[mdf$Cover.Native == 0] <- 0.005 #make 0s a trace amount - could be half the smallest amount
mdf$Phrag_Presence <- as.character(mdf$Phrag_Presence)
mdf$Phrag_Presence[mdf$Phrag_Presence == "W"] <- "Present"
mdf$Phrag_Presence[mdf$Phrag_Presence == "WO"] <- "Absent"
mdf$Phrag_Presence <- as.factor(mdf$Phrag_Presence)
mdf$Density <- as.character(mdf$Density)
mdf$Density[mdf$Density == "H"] <- "High"
mdf$Density[mdf$Density == "L"] <- "Low"
mdf$Density <- as.factor(mdf$Density)
mdf.m1<- glmmTMB(Cover.Native ~ Phrag_Presence * Density * Species  #* for interaction
+ (1|Block),
data = mdf,
family = beta_family)
##phrag presence ####
emm <- emmeans(mdf.m1, pairwise ~ Phrag_Presence, adjust = "tukey", type = "response")
data1 <- multcomp::cld(emm$emmeans, alpha = 0.05, Letters = letters)
data1
ggplot(data = data1, aes(x = Phrag_Presence, y = response * 100)) +
geom_point(size=2) +
geom_errorbar(aes(ymin = 100*(response - SE),
ymax = 100*(response+SE)),
width=0, size=0.5) +
labs(x="Presence of *Phragmites*", y = "Model Predicted Native Cover (%)") +
geom_text(aes(label = .group,  y = response * 100),
nudge_x = 0.1) +
theme(axis.title.x = ggtext::element_markdown())
ggsave("native_cover_presence_model_means.jpeg")
##species by density ####
emm <- emmeans(mdf.m1, pairwise ~ Species * Density, adjust = "tukey", type = "response")
data2 <- multcomp::cld(emm$emmeans, alpha = 0.05, Letters = letters)
data2
data2$.group
group_list <- c("a", "a", "a","a", "ab", "abc", "abcd",
"bcde", "cde", "de", "ef", "ef", "ef", "fg",
"gh", "ghi", "ghi", "ghi", "hi", "hi", "hi",
"hi", "hi", "hi", "hi", "i")
ggplot(data = data2, aes(x = reorder(Species,response), y = response * 100, shape = Density)) +
geom_point(size=2) +
geom_errorbar(aes(ymin = 100*(response - SE),
ymax = 100*(response+SE)),
width=0, size=0.5) +
labs(x="Species", y = "Model Predicted Native Cover (%)") +
geom_text(aes(label = group_list,
vjust = .9, hjust = "left"),
nudge_x = .1,
check_overlap = TRUE) +
theme(axis.text.x = element_text(angle = 45, hjust = 0.9),
axis.title.y = ggtext::element_markdown())
ggsave("native_cover_species_model_means.jpeg")
#Native biomass ####
table(biomass$Species)
mdf <- biomass %>%
dplyr::filter(!is.na(Density),
Species != "JUTO" & Species != "JUGE"  & Species != "SCAM" & Species != "BOMA" & Species != "SYCI") %>%
dplyr::mutate(Species = factor(Species)) #need to remove the factor levels (species) that were removed
table(mdf$Species)
with(mdf, table(Species, Density, Phrag_Presence, useNA = "ifany"))
mdf_avg <- mdf %>%
dplyr::group_by(Block, Phrag_Presence, Density, Species) %>%
dplyr::summarize(Native.Biomass = mean(Native.Biomass),
nobs = dplyr::n()) %>%#to average the BICE where there is an extra observation
dplyr::ungroup()
table(mdf_avg$nobs) #double check to make sure BICE is the only one with 2 observations
summary(mdf_avg$Native.Biomass) #no 0s so log shouldnt be a problem
mdf_avg$Phrag_Presence <- as.character(mdf_avg$Phrag_Presence)
mdf_avg$Phrag_Presence[mdf_avg$Phrag_Presence == "W"] <- "Present"
mdf_avg$Phrag_Presence[mdf_avg$Phrag_Presence == "WO"] <- "Absent"
mdf_avg$Phrag_Presence <- as.factor(mdf_avg$Phrag_Presence)
mdf_avg$Density <- as.character(mdf_avg$Density)
mdf_avg$Density[mdf_avg$Density == "H"] <- "High"
mdf_avg$Density[mdf_avg$Density == "L"] <- "Low"
mdf_avg$Density <- as.factor(mdf_avg$Density)
mdf.m1 <- glmmTMB(sqrt(Native.Biomass) ~ Phrag_Presence * Density * Species #* for interaction
+ (1|Block),
data = mdf_avg
)
emm <- emmeans(mdf.m1, pairwise ~ Species * Density * Phrag_Presence, adjust = "tukey", type = "response")
data3 <- multcomp::cld(emm$emmeans, alpha = 0.05, Letters = letters)
#I actually don't think the letters make sense for this
ggplot(data = data3, aes(x = reorder(Species,response), y = response, shape = Density)) +
geom_point(size=2) +
geom_errorbar(aes(ymin = (response - SE),
ymax = (response+SE)),
width=0, size=0.5) +
labs(x="Species", y = "Model Predicted Native Biomass (g)") +
theme(axis.text.x = element_text(angle = 45, hjust = 0.9),
axis.title.y = ggtext::element_markdown()) +
facet_grid(~Phrag_Presence)
ggsave("native_biomass_three-way_model_means.jpeg")
# Phrag cover ####
mdf <- greenhouse %>%
filter(Species != "PHAU", Phrag_Presence == "W",
Date_Cleaned == "2022-05-16")
##plotResiduals wasn't working so Susan sent me this code to figure out why
##You cannot have any missing values or 0 observations
#see what variables have missing values
mdf %>%
select(Cover.Phrag, Species, Density, Block) %>%
summarise_all(list(~sum(is.na(.))))
#drop observations with NA Cover.Phrag and refactor so that level is dropped
with(mdf, table(Species, useNA = "ifany")) #no observations for PHAU
mdf <- mdf %>%
drop_na(Cover.Phrag) %>%
mutate(Species = factor(Species))
with(mdf, table(Species, useNA = "ifany")) #note absence of Phrag level
mdf$Phrag_Presence <- as.character(mdf$Phrag_Presence)
mdf$Phrag_Presence[mdf$Phrag_Presence == "W"] <- "Present"
mdf$Phrag_Presence[mdf$Phrag_Presence == "WO"] <- "Absent"
mdf$Phrag_Presence <- as.factor(mdf$Phrag_Presence)
mdf$Density <- as.character(mdf$Density)
mdf$Density[mdf$Density == "H"] <- "High"
mdf$Density[mdf$Density == "L"] <- "Low"
mdf$Density <- as.factor(mdf$Density)
#back to model
mdf.m1 <- glmmTMB(Cover.Phrag ~ Species * Density #* for interaction
+ (1|Block),
data = mdf,
family = beta_family #change the family to beta
)
##Species
emm <- emmeans(mdf.m1, pairwise ~ Species, adjust = "tukey", type = "response")
data1 <- multcomp::cld(emm$emmeans, alpha = 0.05, Letters = letters)
ggplot(data = data1, aes(x = reorder(Species, response), y = response * 100)) +
geom_point(size=2) +
ylim(c(0, 40)) +
geom_errorbar(aes(ymin = 100*(response - SE),
ymax = 100*(response+SE)),
width=0, size=0.5) +
labs(x="Species", y = "Model Predicted *Phragmites* Cover (%)") +
geom_text(aes(label = .group,  y = response * 100),
nudge_y = 3.5, nudge_x = .2) +
theme(axis.text.x = element_text(angle = 45, hjust = 0.9),
axis.title.y = ggtext::element_markdown())
ggsave("phrag_cover_model_means.jpeg")
##Density
emm <- emmeans(mdf.m1, pairwise ~ Density, adjust = "tukey", type = "response")
data2 <- multcomp::cld(emm$emmeans, alpha = 0.05, Letters = letters)
ggplot(data = data2, aes(x = Density, y = response * 100)) +
ylim(c(0, 30)) +
geom_point(size=2) +
geom_errorbar(aes(ymin = 100*(response - SE),
ymax = 100*(response+SE)),
width=0, size=0.5) +
labs(x="Density", y = "Model Predicted *Phragmites* Cover (%)") +
geom_text(aes(label = .group,  y = response * 100),
nudge_x = .1) +
theme(axis.title.y = ggtext::element_markdown())
ggsave("phrag_cover_density_model_means.jpeg")
# Phrag biomass ####
mdf <- biomass %>%
filter(Species != "PHAU", Phrag_Presence == "W")
mdf$Phrag_Presence <- as.character(mdf$Phrag_Presence)
mdf$Phrag_Presence[mdf$Phrag_Presence == "W"] <- "Present"
mdf$Phrag_Presence[mdf$Phrag_Presence == "WO"] <- "Absent"
mdf$Phrag_Presence <- as.factor(mdf$Phrag_Presence)
mdf$Density <- as.character(mdf$Density)
mdf$Density[mdf$Density == "H"] <- "High"
mdf$Density[mdf$Density == "L"] <- "Low"
mdf$Density <- as.factor(mdf$Density)
mdf.m1 <- glmmTMB(sqrt(Phrag.Biomass) ~ Species * Density #* for interaction
+ (1|Block),
data = mdf,
family = gaussian
)
##Species ####
emm <- emmeans(mdf.m1, pairwise ~ Species, adjust = "tukey", type = "response")
data2 <- multcomp::cld(emm$emmeans, alpha = 0.05, Letters = letters)
ggplot(data = data2, aes(x = reorder(Species, response), y = response)) +
geom_point(size=2) +
geom_errorbar(aes(ymin = (response - SE),
ymax = (response+SE)),
width=0, size=0.5) +
labs(x="Species", y = "Model Predicted *Phragmites* Biomass (g)") +
geom_text(aes(label = .group,  y = response),
nudge_y = 3.5) +
theme(axis.text.x = element_text(angle = 45, hjust = 0.9),
axis.title.y = ggtext::element_markdown())
ggsave("phrag_biomass_model_means.jpeg")
##Density ####
emm <- emmeans(mdf.m1, pairwise ~ Density, adjust = "tukey", type = "response")
data2 <- multcomp::cld(emm$emmeans, alpha = 0.05, Letters = letters)
ggplot(data = data2, aes(x = Density, y = response)) +
ylim(c(0, 20)) +
geom_point(size=2) +
geom_errorbar(aes(ymin = (response - SE),
ymax = (response+SE)),
width=0, size=0.5) +
labs(x="Density", y = "Model Predicted *Phragmites* Biomass (g)") +
geom_text(aes(label = .group,  y = response),
nudge_x = .1) +
theme(axis.title.y = ggtext::element_markdown())
ggsave("phrag_biomass_density_model_means.jpeg")
