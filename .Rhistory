theme(axis.title.x = ggtext::element_markdown(),
plot.title = element_text(size = 9),
legend.position = "none") +
scale_color_manual(values = color1)
(e + f) + plot_layout(widths = c(1, 3))
##Native cover graphs ####
e <- ggplot(data = data1, aes(x = Phrag_Presence, y = response,
color = Phrag_Presence)) +
geom_point(size=2) +
geom_errorbar(aes(ymin = (response - SE),
ymax = (response+SE)),
width=0, size=0.5) +
labs(x="Presence of <br> *P.australis*", y = "Model Predicted Proportional Native Cover",
title = "(a)") +
ylim(0, 1) +
geom_text(aes(label = str_2,  y = response),
nudge_x = 0.2, color = "black", size = 3) +
theme(axis.title.x = ggtext::element_markdown(),
plot.title = element_text(size = 9),
legend.position = "none") +
scale_color_manual(values = color1)
f <- ggplot(data = data2, aes(x = reorder(Species,response), y = response, color = Density)) +
geom_point(size=2, position = position_jitter(seed=1)) +
geom_errorbar(aes(ymin = (response - SE),
ymax = (response+SE)),
width=0, size=0.5, position = position_jitter(seed=1)) +
labs(x="Native Species Identity", y = "Model Predicted Proportional Native Cover",
title = '(b)') +
ylim(0, 1) +
geom_text(aes(label = str_4,
vjust = 1.7, hjust = -.1),
check_overlap = TRUE,
color = "black", position = position_jitter(seed=1),
size = 3) +
theme(axis.text.x = element_text(angle = 45, hjust = 0.9),
axis.title.y = ggtext::element_markdown(),
plot.title = element_text(size = 9),
legend.position = "bottom") +
scale_color_manual(values = color2)
(e + f) + plot_layout(widths = c(1, 3))
f <- ggplot(data = data2, aes(x = reorder(Species,response), y = response, color = Density)) +
geom_point(size=2, position = position_jitter(seed=1)) +
geom_errorbar(aes(ymin = (response - SE),
ymax = (response+SE)),
width=0, size=0.5, position = position_jitter(seed=1)) +
labs(x="Native Species Identity", y = "Model Predicted Proportional Native Cover",
title = '(b)') +
ylim(0, 1) +
geom_text(aes(label = str_4,
vjust = 1.7, hjust = -.1),
check_overlap = TRUE,
color = "black", position = position_jitter(seed=1),
size = 3) +
theme(axis.text.x = element_text(angle = 45, hjust = 0.9),
axis.title.y = ggtext::element_markdown(size = 10),
plot.title = element_text(size = 9),
legend.position = "bottom") +
scale_color_manual(values = color2)
(e + f) + plot_layout(widths = c(1, 3))
f <- ggplot(data = data2, aes(x = reorder(Species,response), y = response, color = Density)) +
geom_point(size=2, position = position_jitter(seed=1)) +
geom_errorbar(aes(ymin = (response - SE),
ymax = (response+SE)),
width=0, size=0.5, position = position_jitter(seed=1)) +
labs(x="Native Species Identity", y = "Model Predicted Proportional Native Cover",
title = '(b)') +
ylim(0, 1) +
geom_text(aes(label = str_4,
vjust = 1.7, hjust = -.1),
check_overlap = TRUE,
color = "black", position = position_jitter(seed=1),
size = 3) +
theme(axis.text.x = element_text(angle = 45, hjust = 0.9),
axis.title.y = ggtext::element_markdown(),
axis.title.y = ggtext::element_markdown(size = 10),
plot.title = element_text(size = 9),
legend.position = "bottom") +
scale_color_manual(values = color2)
f <- ggplot(data = data2, aes(x = reorder(Species,response), y = response, color = Density)) +
geom_point(size=2, position = position_jitter(seed=1)) +
geom_errorbar(aes(ymin = (response - SE),
ymax = (response+SE)),
width=0, size=0.5, position = position_jitter(seed=1)) +
labs(x="Native Species Identity", y = "Model Predicted Proportional Native Cover",
title = '(b)') +
ylim(0, 1) +
geom_text(aes(label = str_4,
vjust = 1.7, hjust = -.1),
check_overlap = TRUE,
color = "black", position = position_jitter(seed=1),
size = 3) +
theme(axis.text.x = element_text(angle = 45, hjust = 0.9),
axis.title.y = ggtext::element_markdown(),
axis.title.x = ggtext::element_markdown(size = 10),
plot.title = element_text(size = 9),
legend.position = "bottom") +
scale_color_manual(values = color2)
(e + f) + plot_layout(widths = c(1, 3))
f <- ggplot(data = data2, aes(x = reorder(Species,response), y = response, color = Density)) +
geom_point(size=2, position = position_jitter(seed=1)) +
geom_errorbar(aes(ymin = (response - SE),
ymax = (response+SE)),
width=0, size=0.5, position = position_jitter(seed=1)) +
labs(x="Native Species Identity", y = "Model Predicted Proportional Native Cover",
title = '(b)') +
ylim(0, 1) +
geom_text(aes(label = str_4,
vjust = 1.7, hjust = -.1),
check_overlap = TRUE,
color = "black", position = position_jitter(seed=1),
size = 3) +
theme(axis.text.x = element_text(angle = 45, hjust = 0.9),
axis.title.y = ggtext::element_markdown(),
axis.title.x = ggtext::element_markdown(size = 11),
plot.title = element_text(size = 9),
legend.position = "bottom") +
scale_color_manual(values = color2)
(e + f) + plot_layout(widths = c(1, 3))
##Native cover graphs ####
e <- ggplot(data = data1, aes(x = Phrag_Presence, y = response,
color = Phrag_Presence)) +
geom_point(size=2) +
geom_errorbar(aes(ymin = (response - SE),
ymax = (response+SE)),
width=0, size=0.5) +
labs(x="Presence of <br> *P.australis*", y = "Model Predicted Proportional Native Cover",
title = "(a)") +
ylim(0, 1) +
geom_text(aes(label = str_2,  y = response),
nudge_x = 0.2, color = "black", size = 3) +
theme(axis.title.x = ggtext::element_markdown(size = 11),
plot.title = element_text(size = 9),
legend.position = "none") +
scale_color_manual(values = color1)
f <- ggplot(data = data2, aes(x = reorder(Species,response), y = response, color = Density)) +
geom_point(size=2, position = position_jitter(seed=1)) +
geom_errorbar(aes(ymin = (response - SE),
ymax = (response+SE)),
width=0, size=0.5, position = position_jitter(seed=1)) +
labs(x="Native Species Identity", y = "Model Predicted Proportional Native Cover",
title = '(b)') +
ylim(0, 1) +
geom_text(aes(label = str_4,
vjust = 1.7, hjust = -.1),
check_overlap = TRUE,
color = "black", position = position_jitter(seed=1),
size = 3) +
theme(axis.text.x = element_text(angle = 45, hjust = 0.9),
axis.title.y = ggtext::element_markdown(),
axis.title.x = ggtext::element_markdown(size = 11),
plot.title = element_text(size = 9),
legend.position = "bottom") +
scale_color_manual(values = color2)
(e + f) + plot_layout(widths = c(1, 3))
f <- ggplot(data = data2, aes(x = reorder(Species,response), y = response, color = Density)) +
geom_point(size=2, position = position_jitter(seed=1)) +
geom_errorbar(aes(ymin = (response - SE),
ymax = (response+SE)),
width=0, size=0.5, position = position_jitter(seed=1)) +
labs(x="Native Species Identity", y = "Model Predicted Proportional Native Cover",
title = '(b)') +
ylim(0, 1) +
geom_text(aes(label = str_4,
vjust = 1.7, hjust = -.1),
check_overlap = TRUE,
color = "black", position = position_jitter(seed=1),
size = 3) +
theme(axis.text.x = element_text(angle = 45, hjust = 0.9),
axis.title.y = ggtext::element_markdown(),
axis.title.x = ggtext::element_markdown(size = 11),
plot.title = element_text(size = 9),
legend.position = "bottom") +
scale_color_manual(values = color2)
f <- ggplot(data = data2, aes(x = reorder(Species,response), y = response, color = Density)) +
geom_point(size=2, position = position_jitter(seed=1)) +
geom_errorbar(aes(ymin = (response - SE),
ymax = (response+SE)),
width=0, size=0.5, position = position_jitter(seed=1)) +
labs(x="Native Species Identity", y = "Model Predicted Proportional Native Cover",
title = '(b)') +
ylim(0, 1) +
geom_text(aes(label = str_4,
vjust = 1.7, hjust = -.1),
check_overlap = TRUE,
color = "black", position = position_jitter(seed=1),
size = 3) +
theme(axis.text.x = element_text(angle = 45, hjust = 0.9),
axis.title.y = ggtext::element_markdown(),
axis.title.x = ggtext::element_markdown(size = 10),
plot.title = element_text(size = 9),
legend.position = "bottom") +
scale_color_manual(values = color2)
(e + f) + plot_layout(widths = c(1, 3))
ggsave("native_cover_model_means_both.jpeg")
##Native cover graphs ####
e <- ggplot(data = data1, aes(x = Phrag_Presence, y = response,
color = Phrag_Presence)) +
geom_point(size=2) +
geom_errorbar(aes(ymin = (response - SE),
ymax = (response+SE)),
width=0, size=0.5) +
labs(x="Presence of <br> *P.australis*", y = "Model Predicted Proportional Native Cover",
title = "(a)") +
ylim(0, 1) +
geom_text(aes(label = str_2,  y = response),
nudge_x = 0.2, color = "black", size = 3) +
theme(axis.title.x = ggtext::element_markdown(size = 10),
plot.title = element_text(size = 9),
legend.position = "none") +
scale_color_manual(values = color1)
f <- ggplot(data = data2, aes(x = reorder(Species,response), y = response, color = Density)) +
geom_point(size=2, position = position_jitter(seed=1)) +
geom_errorbar(aes(ymin = (response - SE),
ymax = (response+SE)),
width=0, size=0.5, position = position_jitter(seed=1)) +
labs(x="Native Species Identity", y = "Model Predicted Proportional Native Cover",
title = '(b)') +
ylim(0, 1) +
geom_text(aes(label = str_4,
vjust = 1.7, hjust = -.1),
check_overlap = TRUE,
color = "black", position = position_jitter(seed=1),
size = 3) +
theme(axis.text.x = element_text(angle = 45, hjust = 0.9),
axis.title.y = ggtext::element_markdown(),
axis.title.x = ggtext::element_markdown(size = 10),
plot.title = element_text(size = 9),
legend.position = "bottom") +
scale_color_manual(values = color2)
(e + f) + plot_layout(widths = c(1, 3))
##Native cover graphs ####
e <- ggplot(data = data1, aes(x = Phrag_Presence, y = response,
color = Phrag_Presence)) +
geom_point(size=2) +
geom_errorbar(aes(ymin = (response - SE),
ymax = (response+SE)),
width=0, size=0.5) +
labs(x="Presence of <br> *P.australis*", y = "Model Predicted Proportional Native Cover",
title = "(a)") +
ylim(0, 1) +
geom_text(aes(label = str_2,  y = response),
nudge_x = 0.2, color = "black", size = 3) +
theme(axis.title.x = ggtext::element_markdown(size = 11),
plot.title = element_text(size = 9),
legend.position = "none") +
scale_color_manual(values = color1)
f <- ggplot(data = data2, aes(x = reorder(Species,response), y = response, color = Density)) +
geom_point(size=2, position = position_jitter(seed=1)) +
geom_errorbar(aes(ymin = (response - SE),
ymax = (response+SE)),
width=0, size=0.5, position = position_jitter(seed=1)) +
labs(x="Native Species Identity", y = "Model Predicted Proportional Native Cover",
title = '(b)') +
ylim(0, 1) +
geom_text(aes(label = str_4,
vjust = 1.7, hjust = -.1),
check_overlap = TRUE,
color = "black", position = position_jitter(seed=1),
size = 3) +
theme(axis.text.x = element_text(angle = 45, hjust = 0.9),
axis.title.y = ggtext::element_markdown(),
axis.title.x = ggtext::element_markdown(size = 11),
plot.title = element_text(size = 9),
legend.position = "bottom") +
scale_color_manual(values = color2)
(e + f) + plot_layout(widths = c(1, 3))
ggsave("native_cover_model_means_both.jpeg")
#Load objects
load("main_dfs.RData")
library(tidyverse)
library(glmmTMB) #allows us to use a beta distribution
library(DHARMa)
library(emmeans)
library(car)
library(multcompView)
library(gridExtra)
library(patchwork)
greenhouse$Density <- as.factor(greenhouse$Density)
greenhouse$Phrag_Presence <- as.factor(greenhouse$Phrag_Presence)
greenhouse$Species <- as.factor(greenhouse$Species)
options(contrasts = c("contr.sum", "contr.poly"))
#for graphing
color1 <- c("orange", "purple4")
color2 <- c("darkblue", "red3")
#Native cover ####
mdf <- greenhouse %>%
dplyr::filter(!is.na(Density),
Date_Cleaned == "2022-05-16",
Species != "JUTO" & Species != "JUGE"  & Species != "SCAM" & Species != "BOMA"& Species != "SYCI")
mdf$Cover.Native[mdf$Cover.Native == 0] <- 0.005 #make 0s a trace amount - could be half the smallest amount
mdf$Phrag_Presence <- as.character(mdf$Phrag_Presence)
mdf$Phrag_Presence[mdf$Phrag_Presence == "W"] <- "Present"
mdf$Phrag_Presence[mdf$Phrag_Presence == "WO"] <- "Absent"
mdf$Phrag_Presence <- as.factor(mdf$Phrag_Presence)
mdf$Density <- as.character(mdf$Density)
mdf$Density[mdf$Density == "H"] <- "High"
mdf$Density[mdf$Density == "L"] <- "Low"
mdf$Density <- as.factor(mdf$Density)
mdf.m1<- glmmTMB(Cover.Native ~ Phrag_Presence * Density * Species  #* for interaction
+ (1|Block),
data = mdf,
family = beta_family)
Anova(mdf.m1, type = 3)
#Native biomass ####
table(biomass$Species)
mdf <- biomass %>%
dplyr::filter(!is.na(Density),
Species != "JUTO" & Species != "JUGE"  & Species != "SCAM" & Species != "BOMA" & Species != "SYCI") %>%
dplyr::mutate(Species = factor(Species)) #need to remove the factor levels (species) that were removed
table(mdf$Species)
with(mdf, table(Species, Density, Phrag_Presence, useNA = "ifany"))
mdf_avg <- mdf %>%
dplyr::group_by(Block, Phrag_Presence, Density, Species) %>%
dplyr::summarize(Native.Biomass = mean(Native.Biomass),
nobs = dplyr::n()) %>%#to average the BICE where there is an extra observation
dplyr::ungroup()
table(mdf_avg$nobs) #double check to make sure BICE is the only one with 2 observations
summary(mdf_avg$Native.Biomass) #no 0s so log shouldnt be a problem
mdf_avg$Phrag_Presence <- as.character(mdf_avg$Phrag_Presence)
mdf_avg$Phrag_Presence[mdf_avg$Phrag_Presence == "W"] <- "Present"
mdf_avg$Phrag_Presence[mdf_avg$Phrag_Presence == "WO"] <- "Absent"
mdf_avg$Phrag_Presence <- as.factor(mdf_avg$Phrag_Presence)
mdf_avg$Density <- as.character(mdf_avg$Density)
mdf_avg$Density[mdf_avg$Density == "H"] <- "High"
mdf_avg$Density[mdf_avg$Density == "L"] <- "Low"
mdf_avg$Density <- as.factor(mdf_avg$Density)
mdf.m1 <- glmmTMB(sqrt(Native.Biomass) ~ Phrag_Presence * Density * Species #* for interaction
+ (1|Block),
data = mdf_avg
)
#this is messier, fewer observations for each, some boxplots bigger than others, but only 12 observations
#species have different variances that the transformation doesn't stabilize
#library(car)
Anova(mdf.m1, type = 3)
##Biomass####
###BICE####
mdf <- biomass %>%
filter(Species == "BICE", !is.na(Density))
mdf.m1 <- glmmTMB(sqrt(Native.Biomass) ~ Phrag_Presence * Density #* for interaction
+ (1|Block),
data = mdf,
family = gaussian
)
Anova(mdf.m1)
emm <- emmeans(mdf.m1, pairwise ~ Phrag_Presence * Density, adjust = "tukey", type= "response")
data1 <- multcomp::cld(emm$emmeans, alpha = 0.1, Letters = letters)
data1
###DISP####
mdf <- biomass %>%
filter(Species == "DISP", !is.na(Density))
mdf.m2 <- glmmTMB(sqrt(Native.Biomass) ~ Phrag_Presence * Density #* for interaction
+ (1|Block),
data = mdf,
family = gaussian
)
Anova(mdf.m2)
###EPCI####
mdf <- biomass %>%
filter(Species == "EPCI", !is.na(Density))
mdf.m3 <- glmmTMB(sqrt(Native.Biomass) ~ Phrag_Presence * Density #* for interaction
+ (1|Block),
data = mdf,
family = gaussian
)
Anova(mdf.m3)
###EUOC####
mdf <- biomass %>%
filter(Species == "EUOC", !is.na(Density))
mdf.m4 <- glmmTMB(sqrt(Native.Biomass) ~ Phrag_Presence * Density #* for interaction
+ (1|Block),
data = mdf,
family = gaussian
)
Anova(mdf.m4)
emm <- emmeans(mdf.m4, pairwise ~ Density * Phrag_Presence, adjust = "tukey", type = "response")
data4 <- multcomp::cld(emm$emmeans, alpha = 0.1, Letters = letters)
data4
###EUMA####
mdf <- biomass %>%
filter(Species == "EUMA", !is.na(Density))
mdf.m5 <- glmmTMB(sqrt(Native.Biomass) ~ Phrag_Presence * Density #* for interaction
+ (1|Block),
data = mdf,
family = gaussian
)
Anova(mdf.m5)
###HENU####
mdf <- biomass %>%
filter(Species == "HENU", !is.na(Density))
mdf.m6 <- glmmTMB(sqrt(Native.Biomass) ~ Phrag_Presence * Density #* for interaction
+ (1|Block),
data = mdf,
family = gaussian
)
Anova(mdf.m6)
###JUAR####
mdf <- biomass %>%
filter(Species == "JUAR", !is.na(Density))
mdf.m7 <- glmmTMB(sqrt(Native.Biomass) ~ Phrag_Presence * Density #* for interaction
+ (1|Block),
data = mdf,
family = gaussian
)
Anova(mdf.m7)
###MUAS####
mdf <- biomass %>%
filter(Species == "MUAS", !is.na(Density))
mdf.m8 <- glmmTMB(sqrt(Native.Biomass) ~ Phrag_Presence * Density #* for interaction
+ (1|Block),
data = mdf,
family = gaussian
)
Anova(mdf.m8)
emm <- emmeans(mdf.m8, pairwise ~ Phrag_Presence*Density, adjust = "tukey", type = "response")
data8<- multcomp::cld(emm$emmeans, alpha = 0.1, Letters = letters)
data8
###PUNU####
mdf <- biomass %>%
filter(Species == "PUNU", !is.na(Density))
mdf.m9 <- glmmTMB(sqrt(Native.Biomass) ~ Phrag_Presence * Density #* for interaction
+ (1|Block),
data = mdf,
family = gaussian
)
Anova(mdf.m9)
emm <- emmeans(mdf.m9, pairwise ~ Density*Phrag_Presence, adjust = "tukey", type = "response")
data9<- multcomp::cld(emm$emmeans, alpha = 0.1, Letters = letters)
data9
###RUMA####
mdf <- biomass %>%
filter(Species == "RUMA", !is.na(Density))
mdf.m10<- glmmTMB(sqrt(Native.Biomass) ~ Phrag_Presence * Density #* for interaction
+ (1|Block),
data = mdf,
family = gaussian
)
Anova(mdf.m10)
emm <- emmeans(mdf.m10, pairwise ~ Density*Phrag_Presence, adjust = "tukey", type = "response")
data10<- multcomp::cld(emm$emmeans, alpha = 0.1, Letters = letters)
data10
###SCAC####
mdf <- biomass %>%
filter(Species == "SCAC", !is.na(Density))
mdf.m11 <- glmmTMB(sqrt(Native.Biomass) ~ Phrag_Presence * Density #* for interaction
+ (1|Block),
data = mdf,
family = gaussian
)
Anova(mdf.m11)
emm <- emmeans(mdf.m11, pairwise ~ Density*Phrag_Presence, adjust = "tukey", type = "response")
data11<- multcomp::cld(emm$emmeans, alpha = 0.1, Letters = letters)
data11
###SCPU####
mdf <- biomass %>%
filter(Species == "SCPU", !is.na(Density))
mdf.m12 <- glmmTMB(sqrt(Native.Biomass) ~ Phrag_Presence * Density #* for interaction
+ (1|Block),
data = mdf,
family = gaussian
)
Anova(mdf.m12)
emm <- emmeans(mdf.m12, pairwise ~ Phrag_Presence*Density, adjust = "tukey", type = "response")
data12 <- multcomp::cld(emm$emmeans, alpha = 0.1, Letters = letters)
data12
###SOCA####
mdf <- biomass %>%
filter(Species == "SOCA", !is.na(Density))
mdf.m13 <- glmmTMB(sqrt(Native.Biomass) ~ Phrag_Presence * Density #* for interaction
+ (1|Block),
data = mdf,
family = gaussian
)
Anova(mdf.m13)
emm <- emmeans(mdf.m13, pairwise ~ Phrag_Presence*Density, adjust = "tukey", type = "response")
data13 <- multcomp::cld(emm$emmeans, alpha = 0.1, Letters = letters)
data13
###EUOC####
mdf <- biomass %>%
filter(Species == "EUOC", !is.na(Density))
mdf.m4 <- glmmTMB(sqrt(Native.Biomass) ~ Phrag_Presence * Density #* for interaction
+ (1|Block),
data = mdf,
family = gaussian
)
Anova(mdf.m4)
emm <- emmeans(mdf.m4, pairwise ~ Density * Phrag_Presence, adjust = "tukey", type = "response")
data4 <- multcomp::cld(emm$emmeans, alpha = 0.1, Letters = letters)
data4
###MUAS####
mdf <- biomass %>%
filter(Species == "MUAS", !is.na(Density))
mdf.m8 <- glmmTMB(sqrt(Native.Biomass) ~ Phrag_Presence * Density #* for interaction
+ (1|Block),
data = mdf,
family = gaussian
)
Anova(mdf.m8)
emm <- emmeans(mdf.m8, pairwise ~ Phrag_Presence*Density, adjust = "tukey", type = "response")
data8<- multcomp::cld(emm$emmeans, alpha = 0.1, Letters = letters)
data8
###SOCA####
mdf <- biomass %>%
filter(Species == "SOCA", !is.na(Density))
mdf.m13 <- glmmTMB(sqrt(Native.Biomass) ~ Phrag_Presence * Density #* for interaction
+ (1|Block),
data = mdf,
family = gaussian
)
Anova(mdf.m13)
emm <- emmeans(mdf.m13, pairwise ~ Phrag_Presence*Density, adjust = "tukey", type = "response")
data13 <- multcomp::cld(emm$emmeans, alpha = 0.1, Letters = letters)
data13
